<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Electrical Preventive Maintenance Checklist</title>
 <link rel="stylesheet" href="halfyearly.css" />
  </head>
  <body>
    <div class="container">
      <form id="yearlyppmForm">
        <!-- Company Details Section -->
        <div class="form-section active" id="companyDetails">
          <h2>Company Details</h2>
          <div class="table-container">
            <table>
              <tr>
                <td width="30%">
                  <label for="ticketNumber">Ticket Number:</label>
                </td>
                <td><input type="text" id="ticketNumber" required /></td>
              </tr>
              <tr>
                <td><label for="companyName">Company Name:</label></td>
                <td>
                  <select id="companyName" required>
                    <option value="">Select Company</option>
                    <option value="company1">Company 1</option>
                    <option value="company2">Company 2</option>
                  </select>
                </td>
              </tr>
              <tr>
                <td><label for="storeName">Store Name:</label></td>
                <td>
                  <select id="storeName" required>
                    <option value="">Select Store</option>
                    <option value="store1">Store 1</option>
                    <option value="store2">Store 2</option>
                  </select>
                </td>
              </tr>
            </table>
          </div>
          <div class="button-group">
            <button type="button" class="secondary" disabled>Back</button>
            <button
              type="button"
              class="primary"
              onclick="validateCompanyDetails()"
            >
              Next
            </button>
          </div>
        </div>

        <!-- Half-Yearly PPM Section -->
        <div class="form-section" id="yearlyPpm">
          <h2>ELECTRICAL PREVENTIVE MAINTENANCE CHECKLIST - HALF-YEARLY</h2>
          <div class="mobile-helper">
            For best viewing on mobile devices, please rotate your device to
            landscape mode.
          </div>
          <div class="table-container">
            <table>
              <thead>
                <tr>
                  <th width="20%">Equipment</th>
                  <th width="30%">Description</th>
                  <th width="15%">Status</th>
                  <th width="20%">Comments</th>
                  <th width="15%">Photo</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Main Control Panel</td>
                  <td>Ensure tightness of the bus</td>
                  <td>
                    <select id="mainControlPanelStatus" class="status-select">
                      <option disabled selected value="">Choose</option>
                      <option value="ok">OK</option>
                      <option value="not-ok">Not OK</option>
                      <option value="na">N/A</option>
                    </select>
                  </td>
                  <td><input type="text" id="mainControlPanelComment" /></td>
                  <td></td>
                </tr>
                <tr>
                  <td>Bus Duct</td>
                  <td>Ensure tightness of the bus </td>
                  <td>
                    <select id="busDuctStatus" class="status-select">
                      <option disabled selected value="">Choose</option>
                      <option value="ok">OK</option>
                      <option value="not-ok">Not OK</option>
                      <option value="na">N/A</option>
                    </select>
                  </td>
                  <td><input type="text" id="busDuctComment" /></td>
                  <td></td>
                </tr>
                <tr>
                  <td>Earth Pits</td>
                  <td>Perform ER Test and submit Report</td>
                  <td>
                    <select id="earthPitsStatus" class="status-select">
                      <option disabled selected value="">Choose</option>
                      <option value="ok">OK</option>
                      <option value="not-ok">Not OK</option>
                      <option value="na">N/A</option>
                    </select>
                  </td>
                  <td><input type="text" id="earthPitsComment" /></td>
                  <td>
                    <div class="photo-upload">
                      <input
                        type="file"
                        id="earthPitsPhoto"
                        accept="image/*"
                        style="display: none"
                      />
                      <button
                        type="button"
                        class="upload-btn"
                        onclick="document.getElementById('earthPitsPhoto').click()"
                      >
                        Upload Photo
                      </button>
                      <img
                        id="earthPitsPreview"
                        class="photo-preview"
                        style="display: none"
                      />
                    </div>
                    <input type="hidden" id="earthPitsPhotoId">
                  </td>
                </tr>
                <tr>
                  <td>Earth Pits</td>
                  <td>Ensure the tightness of bolts & nuts</td>
                  <td>
                    <select id="earthPits2Status" class="status-select">
                      <option disabled selected value="">Choose</option>
                      <option value="ok">OK</option>
                      <option value="not-ok">Not OK</option>
                      <option value="na">N/A</option>
                    </select>
                  </td>
                  <td><input type="text" id="earthPits2Comment" /></td>
                  <td></td>
                </tr>
                <tr>
                  <td>Capacitor Panel</td>
                  <td>Ensure tightness of the bus</td>
                  <td>
                    <select id="CapacitorPanelStatus" class="status-select">
                      <option disabled selected value="">Choose</option>
                      <option value="ok">OK</option>
                      <option value="not-ok">Not OK</option>
                      <option value="na">N/A</option>
                    </select>
                  </td>
                  <td><input type="text" id="CapacitorPanelComment" /></td>
                  
                </tr>
                <tr>
                  <td>General</td>
                  <td>Perform IR Test and submit report</td>
                  <td>
                    <select id="GeneralStatus" class="status-select">
                      <option disabled selected value="">Choose</option>
                      <option value="ok">OK</option>
                      <option value="not-ok">Not OK</option>
                      <option value="na">N/A</option>
                    </select>
                  </td>
                  <td><input type="text" id="GeneralComment" /></td>
                  <td>
                    <div class="photo-upload">
                        <input type="hidden" id="GeneralPhotoId">
                      <input
                        type="file"
                        id="GeneralPhoto"
                        accept="image/*"
                        style="display: none"
                      />
                      <button
                        type="button"
                        class="upload-btn"
                        onclick="document.getElementById('GeneralPhoto').click()"
                      >
                        Upload Photo
                      </button>
                      <img
                        id="GeneralPhotoPreview"
                        class="photo-preview"
                        style="display: none"
                      />
                    </div>
                  </td>
                </tr>
              
              </tbody>
            </table>
          </div>
          <div class="button-group">
            <button
              type="button"
              class="secondary"
              onclick="showSection('yearlyPpm', 'companyDetails')"
            >
              Back
            </button>
            <button type="button" class="primary" onclick="validateChecklist()">
              Next
            </button>
          </div>
        </div>

        <!-- Selfie Section -->
        <div class="form-section" id="selfieSection">
          <h2>Verification</h2>
          <p>Please capture a timestamped photo with the completed work.</p>

          <div class="camera-container">
            <video id="video" autoplay></video>
            <canvas id="canvas" style="display: none"></canvas>
          </div>

          <div class="camera-controls">
            <button
              type="button"
              class="secondary"
              onclick="showSection('selfieSection', 'yearlyPpm')"
            >
              Back
            </button>
            <button type="button" class="primary" onclick="captureSelfie()">
              Capture Photo
            </button>
          </div>
          <input type="hidden" id="selfiePhotoId">
          <div id="selfieResult" style="margin-top: 20px; text-align: center">
            <img
              id="selfiePreview"
              class="photo-preview"
              style="display: none; margin: 0 auto"

            />
            <p
              id="selfieError"
              style="color: var(--error-color); display: none"
            >
              Please capture a verification photo before proceeding.
            </p>
          </div>

          <div class="button-group" style="margin-top: 30px">
            <button
              type="button"
              class="secondary"
              onclick="showSection('selfieSection', 'yearlyPpm')"
            >
              Back
            </button>
            <button type="button" class="primary" onclick="validateSelfie()">
              Next
            </button>
          </div>
        </div>

        <!-- Preview Section -->
        <div class="form-section" id="previewSection">
          <h2>Preview Submission</h2>

          <h3>Company Information</h3>
          <div class="table-container">
            <table>
              <tr>
                <td width="30%"><strong>Ticket Number:</strong></td>
                <td id="previewTicketNumber"></td>
              </tr>
              <tr>
                <td><strong>Company Name:</strong></td>
                <td id="previewCompanyName"></td>
              </tr>
              <tr>
                <td><strong>Store Name:</strong></td>
                <td id="previewStoreName"></td>
              </tr>
            </table>
          </div>

          <h3>Checklist Summary</h3>
          <div class="table-container">
            <table id="previewChecklistTable">
              <thead>
                <tr>
                  <th>Equipment</th>
                  <th>Description</th>
                  <th>Status</th>
                  <th>Comments</th>
                  <th>Photo</th>
                </tr>
              </thead>
              <tbody>
                <!-- Filled by JavaScript -->
              </tbody>
            </table>
          </div>

          <h3>Verification Photo</h3>
          <div style="text-align: center; margin: 20px 0">
            <img
              id="previewSelfie"
              class="photo-preview"
              style="width: 300px; height: auto; display: none"
            />
          </div>

          <div id="submitMessages">
            <div
              id="error-message"
              style="color: var(--error-color); display: none"
            ></div>
            <div
              id="success-message"
              style="color: var(--primary-color); display: none"
            ></div>
          </div>

          <div class="button-group">
            <button
              type="button"
              class="secondary"
              onclick="showSection('previewSection', 'selfieSection')"
            >
              Back
            </button>
            <button type="submit" class="primary" id="submitForm">
              Submit Checklist
            </button>
          </div>
        </div>
      </form>
    </div>

    <!-- Photo Preview Modal -->
    <div id="imageModal" class="modal-preview">
      <span class="close-modal" onclick="closeModal()">&times;</span>
      <img class="modal-content" id="modalImage" />
    </div>

   <script src="yearlyPpm.js"></script>
  </body>
</html>
